{% extends 'core/dashboard_base.html' %}
{% load static %}

{% block dashboard_title %}Hospital Profile - HemoVital{% endblock %}

{% block extra_dashboard_css %}
    <link rel="stylesheet" href="{% static 'core/css/hospital_profile.css' %}">
{% endblock %}

{% block page_title %}
    Manage Hospital Profile
{% endblock %}

{% block dashboard_content %}

<div class="profile-page-container">
    <div class="content-card">
        <form method="post" enctype="multipart/form-data" novalidate>
            {% csrf_token %}

            <!-- Form Header -->
            <div class="profile-header">
                <h2 class="profile-title">Update Your Information</h2>
                <p class="profile-subtitle">Keep your hospital and admin details up-to-date.</p>
            </div>

            <!-- Profile Picture Section -->
            <div class="profile-picture-section">
                <img src="{{ user.hospitalprofile.hospital_logo.url }}" alt="Hospital Logo" class="current-photo" id="photo-preview">
                <div class="photo-upload-wrapper">
                    <label for="{{ form.hospital_logo.id_for_label }}">Change Logo</label>
                    {{ form.hospital_logo }}
                    <small>JPG, PNG up to 2MB.</small>
                </div>
            </div>

            <!-- Main Form Grid -->
            <div class="form-grid">
                <!-- Admin Information -->
                <div class="form-section">
                    <h3 class="section-title"><i class="fas fa-user-shield"></i> Admin Information</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="{{ form.first_name.id_for_label }}">{{ form.first_name.label }}</label>
                            {{ form.first_name }}
                        </div>
                        <div class="form-group">
                            <label for="{{ form.last_name.id_for_label }}">{{ form.last_name.label }}</label>
                            {{ form.last_name }}
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="{{ form.admin_gender.id_for_label }}">{{ form.admin_gender.label }}</label>
                            {{ form.admin_gender }}
                        </div>
                         <div class="form-group">
                            <label for="{{ form.admin_dob.id_for_label }}">{{ form.admin_dob.label }}</label>
                            {{ form.admin_dob }}
                        </div>
                    </div>
                     <div class="form-group full-width">
                        <label for="{{ form.admin_designation.id_for_label }}">{{ form.admin_designation.label }}</label>
                        {{ form.admin_designation }}
                    </div>
                </div>

                <!-- Hospital Information -->
                <div class="form-section">
                    <h3 class="section-title"><i class="fas fa-hospital"></i> Hospital Information</h3>
                     <div class="form-group full-width">
                        <label for="{{ form.hospital_name.id_for_label }}">{{ form.hospital_name.label }}</label>
                        {{ form.hospital_name }}
                    </div>
                     <div class="form-group full-width">
                        <label for="{{ form.hospital_reg_id.id_for_label }}">{{ form.hospital_reg_id.label }}</label>
                        {{ form.hospital_reg_id }}
                    </div>
                </div>

                <!-- Contact & Location -->
                <div class="form-section">
                    <h3 class="section-title"><i class="fas fa-map-marker-alt"></i> Contact & Location</h3>
                     <div class="form-row">
                        <div class="form-group">
                            <label for="{{ form.contact_number.id_for_label }}">{{ form.contact_number.label }}</label>
                            {{ form.contact_number }}
                        </div>
                        <div class="form-group">
                            <label for="{{ form.website.id_for_label }}">{{ form.website.label }}</label>
                            {{ form.website }}
                        </div>
                    </div>
                    <div class="form-group full-width">
                        <label for="{{ form.address.id_for_label }}">{{ form.address.label }}</label>
                        {{ form.address }}
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="{{ form.city.id_for_label }}">{{ form.city.label }}</label>
                            {{ form.city }}
                        </div>
                        <div class="form-group">
                            <label for="{{ form.state.id_for_label }}">{{ form.state.label }}</label>
                            {{ form.state }}
                        </div>
                         <div class="form-group">
                            <label for="{{ form.pincode.id_for_label }}">{{ form.pincode.label }}</label>
                            {{ form.pincode }}
                        </div>
                    </div>
                </div>

            </div>

            <!-- Form Footer / Submit Button -->
            <div class="profile-footer">
                <button type="submit" class="save-button">
                    <i class="fas fa-save"></i> Save Changes
                </button>
            </div>
        </form>
    </div>
</div>

{% endblock %}

{% block extra_dashboard_js %}
<script>
    // JavaScript for live profile photo preview
    const photoInput = document.getElementById('{{ form.hospital_logo.id_for_label }}');
    const photoPreview = document.getElementById('photo-preview');

    if (photoInput && photoPreview) {
        photoInput.addEventListener('change', function(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    photoPreview.src = e.target.result;
                }
                reader.readAsDataURL(file);
            }
        });
    }
</script>
{% endblock %}
